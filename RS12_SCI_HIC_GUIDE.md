# üî¨ RS-12: Single-cell Hi-C Benchmarking Guide

## üìã –û–±–∑–æ—Ä

RS-12 –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–∞–Ω–Ω—ã–µ **GSE185608** (sci-Hi-C –Ω–∞ –º—ã—à–∏–Ω—ã—Ö ESC) –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–∏–ø–æ—Ç–µ–∑—ã –æ –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã—Ö –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è—Ö –ø—Ä–∏ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∫–µ –∏ X-–∏–Ω–∞–∫—Ç–∏–≤–∞—Ü–∏–∏.

### –ó–∞—á–µ–º —ç—Ç–∏ –¥–∞–Ω–Ω—ã–µ?

- ‚úÖ **–ü—Ä—è–º–æ–π —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∞–ª—å–Ω—ã–π –∞–Ω–∞–ª–æ–≥** RS-10/RS-11 (bookmarking/mitosis)
- ‚úÖ **Single-cell —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –∫–ª–µ—Ç–∫–∞–º
- ‚úÖ **–î–∏–Ω–∞–º–∏–∫–∞ –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∫–∏** ‚Äî –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–µ vs –ø–ª–∞–≤–Ω—ã–µ –ø–µ—Ä–µ—Ö–æ–¥—ã
- ‚úÖ **X-–∏–Ω–∞–∫—Ç–∏–≤–∞—Ü–∏—è** ‚Äî —Å–ø–µ—Ü–∏–∞–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ç–µ–æ—Ä–∏–∏

---

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### –®–∞–≥ 1: –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö

**–í–∞—Ä–∏–∞–Ω—Ç A: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)**

```powershell
cd "D:\–î–ù–ö –ö–£–†–°–û–†"
python download_hic_datasets.py
```

–≠—Ç–æ –∑–∞–≥—Ä—É–∑–∏—Ç –≤—Å–µ –¥–∞—Ç–∞—Å–µ—Ç—ã, –≤–∫–ª—é—á–∞—è GSE185608 —Ñ–∞–π–ª—ã (~65 MB).

**–í–∞—Ä–∏–∞–Ω—Ç B: –í—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ PowerShell**

```powershell
cd "D:\–î–ù–ö –ö–£–†–°–û–†"
mkdir -Force data\real

$urls = @(
  "https://ftp.ncbi.nlm.nih.gov/geo/series/GSE185nnn/GSE185608/suppl/GSE185608_4DNFIZ8TEE2M.tar.gz",
  "https://ftp.ncbi.nlm.nih.gov/geo/series/GSE185nnn/GSE185608/suppl/GSE185608_4DNFI7QQWLOV.txt.gz",
  "https://ftp.ncbi.nlm.nih.gov/geo/series/GSE185nnn/GSE185608/suppl/GSE185608_4DNFICOPS6ER.txt.gz"
)

foreach ($url in $urls) {
  $file = Split-Path $url -Leaf
  $out = "data/real/$file"
  Write-Host "Downloading $file ..."
  Invoke-WebRequest -Uri $url -OutFile $out
}
```

### –®–∞–≥ 2: –†–∞—Å–ø–∞–∫–æ–≤–∫–∞ –¥–∞–Ω–Ω—ã—Ö

```powershell
python extract_sci_hic.py
```

–≠—Ç–æ—Ç —Å–∫—Ä–∏–ø—Ç:
- –†–∞—Å–ø–∞–∫—É–µ—Ç `GSE185608_4DNFIZ8TEE2M.tar.gz`
- –†–∞—Å–ø–∞–∫—É–µ—Ç –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ `.gz` —Ñ–∞–π–ª—ã
- –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö
- –ü–æ–∫–∞–∂–µ—Ç, –∫–∞–∫–∏–µ —Ñ–∞–π–ª—ã –Ω–∞–π–¥–µ–Ω—ã

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –î–∞–Ω–Ω—ã–µ –±—É–¥—É—Ç –≤ `data/real/GSE185608_sciHiC/`

### –®–∞–≥ 3: –ò–∑—É—á–µ–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –¥–∞–Ω–Ω—ã—Ö

–ü–æ—Å–ª–µ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏ –∏–∑—É—á–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ:

```powershell
Get-ChildItem data/real/GSE185608_sciHiC -Recurse | Select-Object FullName, Length | Format-Table
```

–û–∂–∏–¥–∞–µ–º—ã–µ —Ç–∏–ø—ã —Ñ–∞–π–ª–æ–≤:
- `.cool` / `.mcool` ‚Äî –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã
- `.txt` / `.tsv` ‚Äî –∫–æ–Ω—Ç–∞–∫—Ç-–ª–∏—Å—Ç—ã
- `.h5` / `.hdf5` ‚Äî HDF5 –¥–∞–Ω–Ω—ã–µ
- –ü–∞–ø–∫–∏ –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º (day0, day7, day20, etc.)

### –®–∞–≥ 4: –ó–∞–ø—É—Å–∫ –±–µ–Ω—á–º–∞—Ä–∫–∞

```powershell
python experiments/run_RS12_sci_hic_benchmark.py
```

**–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ:** –°–∫—Ä–∏–ø—Ç —Ç—Ä–µ–±—É–µ—Ç –∞–¥–∞–ø—Ç–∞—Ü–∏–∏ –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—É—é —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö. –°–Ω–∞—á–∞–ª–∞ –∏–∑—É—á–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ä—Ö–∏–≤–∞.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ñ–∞–π–ª–æ–≤

–ü–æ—Å–ª–µ –∑–∞–≥—Ä—É–∑–∫–∏ –∏ —Ä–∞—Å–ø–∞–∫–æ–≤–∫–∏:

```
data/real/
‚îú‚îÄ‚îÄ GSE185608_4DNFIZ8TEE2M.tar.gz          # –û—Å–Ω–æ–≤–Ω–æ–π –∞—Ä—Ö–∏–≤ (~65 MB)
‚îú‚îÄ‚îÄ GSE185608_4DNFI7QQWLOV.txt.gz          # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª
‚îú‚îÄ‚îÄ GSE185608_4DNFICOPS6ER.txt.gz          # –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π —Ñ–∞–π–ª
‚îî‚îÄ‚îÄ GSE185608_sciHiC/                      # –†–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
    ‚îú‚îÄ‚îÄ [—Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∞—Ä—Ö–∏–≤–∞]
    ‚îú‚îÄ‚îÄ [—Ñ–∞–π–ª—ã –ø–æ —Å–æ—Å—Ç–æ—è–Ω–∏—è–º/–¥–Ω—è–º]
    ‚îî‚îÄ‚îÄ [–∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã/–ª–∏—Å—Ç—ã]
```

---

## üîß –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ

–°–∫—Ä–∏–ø—Ç `run_RS12_sci_hic_benchmark.py` —Å–æ–¥–µ—Ä–∂–∏—Ç –∑–∞–≥–ª—É—à–∫–∏ –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ –¥–∞–Ω–Ω—ã—Ö. –ù—É–∂–Ω–æ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞—Ç—å:

### 1. –§—É–Ω–∫—Ü–∏—è `load_sci_hic_data()`

–ò–∑—É—á–∏—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω–Ω—ã—Ö —Ñ–∞–π–ª–æ–≤ –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Ñ—É–Ω–∫—Ü–∏—é:

```python
def load_sci_hic_data(self, condition: str = "esc") -> dict[str, Any]:
    # –ù–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª—ã –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏—è
    # –ù–∞–ø—Ä–∏–º–µ—Ä:
    # - condition="esc" ‚Üí —Ñ–∞–π–ª—ã —Å "esc" –∏–ª–∏ "day0" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
    # - condition="day7" ‚Üí —Ñ–∞–π–ª—ã —Å "day7" –∏–ª–∏ "d7" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
    # - condition="x_inactive" ‚Üí —Ñ–∞–π–ª—ã —Å "x_inactive" –∏–ª–∏ "xi" –≤ –Ω–∞–∑–≤–∞–Ω–∏–∏
    
    # –ó–∞–≥—Ä—É–∑–∏—Ç–µ –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–µ –º–∞—Ç—Ä–∏—Ü—ã –∏–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç-–ª–∏—Å—Ç—ã
    # –í—ã—á–∏—Å–ª–∏—Ç–µ P(s) –ø—Ä–æ—Ñ–∏–ª–∏
    # –í–µ—Ä–Ω–∏—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

### 2. –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö

–í –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ñ–æ—Ä–º–∞—Ç–∞ —Ñ–∞–π–ª–æ–≤:

**–ï—Å–ª–∏ .cool/.mcool:**
```python
import cooler
c = cooler.Cooler("path/to/file.cool")
matrix = c.matrix(balance=False)[:]
p_s = compute_p_s_from_matrix(matrix)
```

**–ï—Å–ª–∏ –∫–æ–Ω—Ç–∞–∫—Ç-–ª–∏—Å—Ç—ã (.txt/.tsv):**
```python
import pandas as pd
contacts = pd.read_csv("path/to/contacts.txt", sep="\t")
# –ü—Ä–µ–æ–±—Ä–∞–∑—É–π—Ç–µ –≤ –º–∞—Ç—Ä–∏—Ü—É –∏–ª–∏ –≤—ã—á–∏—Å–ª–∏—Ç–µ P(s) –Ω–∞–ø—Ä—è–º—É—é
```

**–ï—Å–ª–∏ HDF5 (.h5):**
```python
import h5py
with h5py.File("path/to/file.h5", "r") as f:
    matrix = f["contacts"][:]
```

---

## üìä –ß—Ç–æ –¥–µ–ª–∞–µ—Ç RS-12

1. **–ó–∞–≥—Ä—É–∂–∞–µ—Ç sci-Hi-C –¥–∞–Ω–Ω—ã–µ** –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —É—Å–ª–æ–≤–∏–π (ESC, –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏—Ä–æ–≤–∫–∞, X-–∏–Ω–∞–∫—Ç–∏–≤–∞—Ü–∏—è)

2. **–í—ã—á–∏—Å–ª—è–µ—Ç P(s) –ø—Ä–æ—Ñ–∏–ª–∏** –∏–∑ —Ä–µ–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö

3. **–ì–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç —Å–∏–º—É–ª—è—Ü–∏–∏** —Å —Ä–∞–∑–Ω—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏ processivity/bookmarking:
   - ESC: –≤—ã—Å–æ–∫–∏–π bookmarking (0.9), —Å—Ä–µ–¥–Ω—è—è processivity (1.0)
   - Differentiated: —Å–Ω–∏–∂–µ–Ω–∏–µ bookmarking (0.7)
   - X-inactive: –æ—Å–æ–±—ã–π —Ä–µ–∂–∏–º (0.6 bookmarking, 0.8 processivity)

4. **–°—Ä–∞–≤–Ω–∏–≤–∞–µ—Ç** —Ä–µ–∞–ª—å–Ω—ã–µ –∏ —Å–∏–º—É–ª–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ P(s) –ø—Ä–æ—Ñ–∏–ª–∏:
   - –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è
   - MSE (Mean Squared Error)
   - MAE (Mean Absolute Error)

5. **–ü—Ä–æ–≤–µ—Ä—è–µ—Ç –≥–∏–ø–æ—Ç–µ–∑—É:** —Å—Ç—Ä—É–∫—Ç—É—Ä–Ω—ã–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –¥–∏—Å–∫—Ä–µ—Ç–Ω—ã–µ, –∞ —ç–∫—Å–ø—Ä–µ—Å—Å–∏—è –ø–ª–∞–≤–Ω–∞—è

---

## üéØ –û–∂–∏–¥–∞–µ–º—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã

–ü–æ—Å–ª–µ —É—Å–ø–µ—à–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞:

- `data/output/RS12/RS12_sci_hic_results.json` ‚Äî –º–µ—Ç—Ä–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è
- `figures/RS12/` ‚Äî –≥—Ä–∞—Ñ–∏–∫–∏ —Å—Ä–∞–≤–Ω–µ–Ω–∏—è P(s) –ø—Ä–æ—Ñ–∏–ª–µ–π
- –ê–Ω–∞–ª–∏–∑ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è –ø–æ –∫–ª–µ—Ç–∫–∞–º (variance –≤ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ)

---

## ‚ö†Ô∏è Troubleshooting

### –ü—Ä–æ–±–ª–µ–º–∞: –ê—Ä—Ö–∏–≤ –Ω–µ —Ä–∞—Å–ø–∞–∫–æ–≤—ã–≤–∞–µ—Ç—Å—è

**–†–µ—à–µ–Ω–∏–µ:**
```powershell
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª —Å–∫–∞—á–∞–Ω –ø–æ–ª–Ω–æ—Å—Ç—å—é
Get-Item data/real/GSE185608_4DNFIZ8TEE2M.tar.gz | Select-Object Length

# –†–∞—Å–ø–∞–∫—É–π—Ç–µ –≤—Ä—É—á–Ω—É—é
cd data/real
tar -xvf GSE185608_4DNFIZ8TEE2M.tar.gz
```

### –ü—Ä–æ–±–ª–µ–º–∞: –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç –æ–∂–∏–¥–∞–Ω–∏—è–º

**–†–µ—à–µ–Ω–∏–µ:**
1. –ò–∑—É—á–∏—Ç–µ —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ –∞—Ä—Ö–∏–≤–∞: `extract_sci_hic.py` –ø–æ–∫–∞–∂–µ—Ç —Å—Ç—Ä—É–∫—Ç—É—Ä—É
2. –ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ `load_sci_hic_data()` –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é GSE185608 –Ω–∞ GEO

### –ü—Ä–æ–±–ª–µ–º–∞: –ù–µ –º–æ–≥—É –Ω–∞–π—Ç–∏ —Ñ–∞–π–ª—ã –¥–ª—è —É—Å–ª–æ–≤–∏–π

**–†–µ—à–µ–Ω–∏–µ:**
- –ò–∑—É—á–∏—Ç–µ –Ω–∞–∑–≤–∞–Ω–∏—è —Ñ–∞–π–ª–æ–≤/–ø–∞–ø–æ–∫ –≤ –∞—Ä—Ö–∏–≤–µ
- –ê–¥–∞–ø—Ç–∏—Ä—É–π—Ç–µ –ª–æ–≥–∏–∫—É –ø–æ–∏—Å–∫–∞ –≤ `load_sci_hic_data()`
- –í–æ–∑–º–æ–∂–Ω–æ, –Ω—É–∂–Ω–æ –æ–±—ä–µ–¥–∏–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ —Ñ–∞–π–ª–æ–≤ –¥–ª—è –æ–¥–Ω–æ–≥–æ —É—Å–ª–æ–≤–∏—è

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- **GEO GSE185608**: https://www.ncbi.nlm.nih.gov/geo/query/acc.cgi?acc=GSE185608
- **sci-Hi-C –º–µ—Ç–æ–¥**: https://www.nature.com/articles/nmeth.4153
- **X-–∏–Ω–∞–∫—Ç–∏–≤–∞—Ü–∏—è –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞**: –°–º. –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—É—é –ø—É–±–ª–∏–∫–∞—Ü–∏—é GSE185608

---

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç

- [ ] –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã (`download_hic_datasets.py`)
- [ ] –ê—Ä—Ö–∏–≤ —Ä–∞—Å–ø–∞–∫–æ–≤–∞–Ω (`extract_sci_hic.py`)
- [ ] –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑—É—á–µ–Ω–∞
- [ ] `load_sci_hic_data()` –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω–∞ –ø–æ–¥ —Ä–µ–∞–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã
- [ ] –ë–µ–Ω—á–º–∞—Ä–∫ –∑–∞–ø—É—â–µ–Ω (`run_RS12_sci_hic_benchmark.py`)
- [ ] –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω—ã

**–ì–æ—Ç–æ–≤–æ! üéâ**




