# RS-09: NIPBL-WAPL Coupled Dynamics

**Status:** Active  
**Priority:** Maximum  
**Risk IDs:** P3, S2  
**Dependencies:** ARCHCODE v1.1, RS-06, RS-07

---

## Goal

Исследовать связку **NIPBL Rate Kinetics (P3)** и **WAPL Recruitment Logic (S2)** как детерминанту стабильности TAD границ и рисков коллапса.

**Гипотеза:** Loop Processivity = Rate(NIPBL) × Lifetime(WAPL) определяет архитектурную стабильность генома.

---

## Background

### ARCHCODE v1.1 Insights

1. **NIPBL** — не бинарный загрузчик, а **velocity multiplier**
   - Контролирует скорость экструзии (V_ext)
   - Снижение NIPBL → замедление петель (CdLS)

2. **WAPL** — **lifetime controller**
   - Контролирует время жизни когезина
   - Рекрутинг через FGF мотивы, R-loops, G4

3. **Processivity = Rate × Lifetime**
   - Это определяет размер петель
   - Влияет на стабильность границ
   - Связано с рисками коллапса

### Research Question

**Как связаны NIPBL velocity и WAPL lifetime с:**
- Стабильностью TAD границ?
- Вероятностью коллапса?
- Рисками enhancer hijacking?

---

## Method

### Phase 1: CdLS Simulation

**Гипотеза:** NIPBL haploinsufficiency (50% velocity) → размытие TAD границ

**Метод:**
1. Wild-type: `nipbl_velocity_multiplier = 1.0`
2. CdLS: `nipbl_velocity_multiplier = 0.5`
3. Сравнить стабильность границ
4. Измерить collapse probability
5. Оценить риски hijacking

**Метрики:**
- Average stability score
- Number of stable boundaries
- Collapse probability
- Enhancer hijacking risk

**Ожидаемый результат:**
- Падение стабильности на 20-30%
- Рост collapse probability
- Увеличение рисков

---

### Phase 2: WAPL Overactivation Test

**Гипотеза:** Избыточный WAPL recruitment → петли не успевают расти → нестабильность

**Метод:**
1. Wild-type: `wapl_lifetime_factor = 1.0`
2. Overactivation: `wapl_lifetime_factor = 0.3` (70% reduction)
3. R-loop hotspots → повышенный WAPL recruitment
4. G4 structures → повышенный WAPL recruitment

**Метрики:**
- Loop size distribution
- Boundary stability
- Collapse frequency
- Oncogenic risk

**Ожидаемый результат:**
- Уменьшение размера петель
- Падение стабильности границ
- Рост коллапсов
- Увеличение онкогенных рисков

---

### Phase 3: Coupled Dynamics Sweep

**Гипотеза:** Существует фазовый переход в пространстве (NIPBL velocity, WAPL lifetime)

**Метод:**
1. Sweep по двум осям:
   - X: `nipbl_velocity_multiplier` [0.3, 0.5, 0.7, 1.0, 1.3]
   - Y: `wapl_lifetime_factor` [0.3, 0.5, 0.7, 1.0, 1.5, 2.0]
2. Для каждой комбинации:
   - Измерить stability scores
   - Вычислить collapse probability
   - Оценить риски
3. Построить фазовую карту

**Метрики:**
- Stability landscape
- Collapse probability map
- Risk heatmap
- Phase transition boundaries

**Ожидаемый результат:**
- Карта фазовых режимов
- Зоны TAD erosion
- Зоны hyper-looping
- Граница фазового перехода

---

## Implementation

### Experiment E-P3-S2-01: CdLS Simulation

**Файл:** `experiments/run_P3_S2_cdls.py`

**Цель:** Симулировать эффекты CdLS (NIPBL haploinsufficiency)

**Входы:**
- Boundaries dataset
- NIPBL velocity multiplier: 0.5

**Выходы:**
- Stability comparison (WT vs CdLS)
- Collapse probability
- Risk assessment

---

### Experiment E-P3-S2-02: WAPL Overactivation

**Файл:** `experiments/run_P3_S2_wapl_overactivation.py`

**Цель:** Симулировать эффекты избыточного WAPL recruitment

**Входы:**
- Boundaries dataset
- R-loop hotspots
- G4 structures
- WAPL lifetime factor: 0.3

**Выходы:**
- Loop size distribution
- Stability scores
- Collapse frequency
- Oncogenic risk

---

### Experiment E-P3-S2-03: Coupled Dynamics Sweep

**Файл:** `experiments/run_P3_S2_coupled_sweep.py`

**Цель:** Построить фазовую карту (NIPBL velocity × WAPL lifetime)

**Входы:**
- Boundaries dataset
- Sweep ranges для обоих параметров

**Выходы:**
- Stability landscape (2D heatmap)
- Collapse probability map
- Risk heatmap
- Phase transition boundaries

---

## Expected Outcomes

### Scientific Insights

1. **Quantitative relationship:**
   - Как NIPBL velocity влияет на stability
   - Как WAPL lifetime влияет на stability
   - Взаимодействие между ними

2. **Phase transitions:**
   - Границы между стабильными и нестабильными режимами
   - Критические значения параметров

3. **Disease modeling:**
   - CdLS: количественная модель размытия TAD
   - WAPL overactivation: модель нестабильности

### Technical Deliverables

1. **Experiments:**
   - 3 экспериментальных скрипта
   - Результаты и визуализации
   - Отчеты

2. **Models:**
   - Калиброванная модель processivity
   - Фазовая карта
   - Правила предсказания

3. **Documentation:**
   - RS-09 specification
   - Methodology
   - Results interpretation

---

## Integration with ARCHCODE

### Current State

✅ **ARCHCODE v1.1:**
- NIPBL velocity multiplier реализован
- WAPL lifetime factor реализован
- Processivity = Rate × Lifetime

✅ **Boundary Stability Predictor:**
- Модель стабильности готова
- Корреляция 0.79 с экспериментальными данными

✅ **Boundary Collapse Simulator:**
- Симулятор коллапса готов
- Risk scoring реализован

✅ **Full Pipeline:**
- Интеграция всех компонентов
- Экспорт результатов

### Next Steps

1. **Запустить Experiment E-P3-S2-01** (CdLS)
2. **Запустить Experiment E-P3-S2-02** (WAPL overactivation)
3. **Запустить Experiment E-P3-S2-03** (Coupled sweep)
4. **Проанализировать результаты**
5. **Подготовить научный отчет**

---

## Success Criteria

- ✅ CdLS simulation показывает размытие TAD
- ✅ WAPL overactivation показывает нестабильность
- ✅ Coupled sweep выявляет фазовые переходы
- ✅ Результаты воспроизводимы
- ✅ Готовность к публикации

---

**Status:** Ready for Implementation  
**Priority:** Maximum  
**Estimated Time:** 1 week for all phases










