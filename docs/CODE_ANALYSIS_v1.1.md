# –ê–Ω–∞–ª–∏–∑ —Ç–µ–∫—É—â–µ–≥–æ –∫–æ–¥–∞: Velocity Integration v1.1

**–î–∞—Ç–∞:** 23 –Ω–æ—è–±—Ä—è 2025  
**–°—Ç–∞—Ç—É—Å:** –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞, —Ç—Ä–µ–±—É–µ—Ç—Å—è –æ—Ç–ª–∞–¥–∫–∞

---

## üìÇ –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `src/boundary_stability/stability_model.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –§–æ—Ä–º—É–ª–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞: –¥–æ–±–∞–≤–ª–µ–Ω—ã `V_nipbl √ó L_wapl`
- ‚úÖ Processivity factor –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ `predict()`
- ‚úÖ –§–æ—Ä–º—É–ª–∞: `Stability = Base √ó processivity_factor`

**–ö–ª—é—á–µ–≤–æ–π –∫–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∏ 74-87
base_stability = (
    factors.ctcf_strength
    * (1.0 + factors.energy_barrier * self.barrier_multiplier)
    * factors.epigenetic_context
    * (1.0 + factors.te_motif_effect * self.te_multiplier)
    * factors.temporal_factor
)

processivity_factor = factors.nipbl_velocity_factor * factors.wapl_lifetime_factor
stability = base_stability * processivity_factor
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 2. `src/boundary_stability/factor_aggregator.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–ª—è –≤ `StabilityFactors`: `nipbl_velocity_factor`, `wapl_lifetime_factor`
- ‚úÖ –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ `aggregate_all_factors()`

**–ö–ª—é—á–µ–≤–æ–π –∫–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∏ 15-17
nipbl_velocity_factor: float = 1.0  # v1.1: NIPBL velocity multiplier
wapl_lifetime_factor: float = 1.0  # v1.1: WAPL lifetime multiplier
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 3. `src/boundary_stability/stability_calculator.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `vizir_configs` –≤ `__init__()`
- ‚úÖ –ú–µ—Ç–æ–¥ `_extract_processivity_factors()` –∏–∑–≤–ª–µ–∫–∞–µ—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ P3/S2 configs
- ‚úÖ –ó–Ω–∞—á–µ–Ω–∏—è –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `aggregate_all_factors()`

**–ö–ª—é—á–µ–≤–æ–π –∫–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∏ 32-50: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ñ–∞–∫—Ç–æ—Ä–æ–≤
def _extract_processivity_factors(self) -> None:
    if "P3" in self.vizir_configs:
        p3_params = self.vizir_configs["P3"].get("parameters", {})
        if "nipbl_velocity_multiplier" in p3_params:
            multipliers = p3_params["nipbl_velocity_multiplier"]
            self.default_nipbl_velocity = multipliers.get(
                "wild_type",
                multipliers.get("cdls_haploinsufficient", 1.0)
            )
```

**–ü—Ä–æ–±–ª–µ–º–∞:** ‚ö†Ô∏è –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞–µ—Ç, –Ω–æ –≤ —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–µ –º—ã –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º `wild_type`, —á—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–±–∞ —Å–ª—É—á–∞—è

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

### 4. `src/archcode_core/pipeline.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `vizir_configs` –≤ `__init__()`
- ‚úÖ `vizir_configs` –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `StabilityCalculator`

**–ö–ª—é—á–µ–≤–æ–π –∫–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∏ 24, 40, 46
def __init__(self, ..., vizir_configs: dict | None = None):
    self.vizir_configs = vizir_configs or {}
    self.stability_calculator = StabilityCalculator(
        stability_config, vizir_configs=self.vizir_configs
    )
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 5. `src/archcode_core/full_pipeline.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ `vizir_configs` –ø–µ—Ä–µ–¥–∞—é—Ç—Å—è –≤ `ARCHCODEPipeline`

**–ö–ª—é—á–µ–≤–æ–π –∫–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∞ 58-61
self.pipeline = ARCHCODEPipeline(
    archcode_config=archcode_config,
    stability_config=stability_config,
    vizir_configs=vizir_configs,
)
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 6. `src/archcode_core/extrusion_engine.py`

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω –ø–∞—Ä–∞–º–µ—Ç—Ä `cell_phase` (v1.1: phase-dependent symmetry)
- ‚úÖ `nipbl_velocity_multiplier` –∏ `wapl_lifetime_factor` –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –∏–∑ P3 config
- ‚úÖ Velocity –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ `load_cohesin()`
- ‚úÖ Lifetime –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –≤ `update_extrusion()`

**–ö–ª—é—á–µ–≤–æ–π –∫–æ–¥:**
```python
# –°—Ç—Ä–æ–∫–∏ 119-132: –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –∏–∑ P3
if "nipbl_velocity_multiplier" in params:
    multipliers = params["nipbl_velocity_multiplier"]
    self.nipbl_velocity_multiplier = multipliers.get("wild_type", 1.0)

# –°—Ç—Ä–æ–∫–∏ 152-154: –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ velocity
base_speed = self.extrusion_params.get("extrusion_speed", 1.0)
effective_speed = base_speed * self.nipbl_velocity_multiplier
```

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ

---

### 7. `experiments/run_P3_S2_cdls.py`

**–ü—Ä–æ–±–ª–µ–º–∞:** ‚ö†Ô∏è 
```python
# –°—Ç—Ä–æ–∫–∞ 72: –ü–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º wild_type
p3_params["nipbl_velocity_multiplier"]["wild_type"] = 0.5
```

**–ü—Ä–æ–±–ª–µ–º–∞:** –ú—ã –ø–µ—Ä–µ–∑–∞–ø–∏—Å—ã–≤–∞–µ–º `wild_type` –¥–ª—è CdLS, –Ω–æ —ç—Ç–æ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ–±–∞ —Å–ª—É—á–∞—è, –ø–æ—Ç–æ–º—É —á—Ç–æ –æ–±–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `cdls_haploinsufficient` –≤–º–µ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ `wild_type`

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è

---

## üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º—ã

### –¢–µ–∫—É—â–∏–π flow:

1. **–≠–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç:** –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `wild_type = 0.5` –¥–ª—è CdLS
2. **StabilityCalculator:** –ò–∑–≤–ª–µ–∫–∞–µ—Ç `wild_type` –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
3. **–ü—Ä–æ–±–ª–µ–º–∞:** –û–±–∞ —Å–ª—É—á–∞—è (WT –∏ CdLS) –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω –∏ —Ç–æ—Ç –∂–µ –∫–ª—é—á

### –ü–æ—á–µ–º—É –Ω–µ—Ç —Ä–∞–∑–Ω–∏—Ü—ã:

**–ì–∏–ø–æ—Ç–µ–∑–∞:** –ó–Ω–∞—á–µ–Ω–∏—è –∏–∑–≤–ª–µ–∫–∞—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –Ω–æ:
- –õ–∏–±–æ –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –≤ —Ñ–æ—Ä–º—É–ª–µ
- –õ–∏–±–æ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –æ–¥–∏–Ω–∞–∫–æ–≤–æ –¥–ª—è –æ–±–æ–∏—Ö —Å–ª—É—á–∞–µ–≤
- –õ–∏–±–æ –ø—Ä–æ–±–ª–µ–º–∞ –≤ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–∏ –∫–æ–Ω—Ñ–∏–≥–æ–≤

**–ü—Ä–æ–≤–µ—Ä–∫–∞:**
- –ö–æ–Ω—Ñ–∏–≥ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è ‚úÖ
- –ó–Ω–∞—á–µ–Ω–∏—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç ‚úÖ
- –§–æ—Ä–º—É–ª–∞ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è ‚úÖ
- –ù–æ —Ä–∞–∑–Ω–∏—Ü—ã –Ω–µ—Ç ‚ùå

---

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á

```python
# –í–º–µ—Å—Ç–æ –ø–µ—Ä–µ–∑–∞–ø–∏—Å–∏ wild_type
p3_params["nipbl_velocity_multiplier"]["wild_type"] = 0.5

# –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cdls_haploinsufficient
# –ò –∏–∑–º–µ–Ω–∏—Ç—å –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –≤ StabilityCalculator
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ü–µ—Ä–µ–¥–∞–≤–∞—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è –Ω–∞–ø—Ä—è–º—É—é

```python
# –í calculate_stability() –ø–µ—Ä–µ–¥–∞–≤–∞—Ç—å nipbl_velocity_factor –Ω–∞–ø—Ä—è–º—É—é
prediction = self.stability_calculator.calculate_stability(
    ...,
    nipbl_velocity_factor=0.5,  # –î–ª—è CdLS
)
```

---

## üìä –°–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–µ v1.2 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏–∏

### –ß—Ç–æ —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ (v1.1):
- ‚úÖ NIPBL velocity multiplier
- ‚úÖ WAPL lifetime factor
- ‚úÖ Processivity = Rate √ó Lifetime
- ‚úÖ Phase-dependent symmetry (interphase vs mitosis)

### –ß—Ç–æ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç –¥–ª—è v1.2:
- ‚ùå –§–∞–∑–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ –º–∏—Ç–æ–∑ ‚Üí G1
- ‚ùå STAG1/STAG2 —ç–∫—Å—Ç—Ä—É–¥–µ—Ä—ã
- ‚ùå WAPL TE/Non-B field
- ‚ùå CdLS —Å–∫–æ—Ä–æ—Å—Ç—å –∫–∞–∫ –ø–∞—Ç–æ–ª–æ–≥–∏—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
- ‚ùå Bookmarking CTCF

---

## üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### –í–∞—Ä–∏–∞–Ω—Ç A: –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ü–ª–∞–Ω:**
1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —Ç–µ–∫—É—â—É—é –ø—Ä–æ–±–ª–µ–º—É —Å –ø–µ—Ä–µ–¥–∞—á–µ–π velocity
2. –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã CdLS
3. –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ v1.2

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ë—ã—Å—Ç—Ä—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
- –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è
- –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–æ—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç–∏

### –í–∞—Ä–∏–∞–Ω—Ç B: –ü–æ–ª–Ω–∞—è –ø–µ—Ä–µ—Ä–∞–±–æ—Ç–∫–∞ –ø–æ–¥ v1.2

**–ü–ª–∞–Ω:**
1. –ü–µ—Ä–µ—Ä–∞–±–æ—Ç–∞—Ç—å —è–¥—Ä–æ –ø–æ–¥ v1.2 —Å–ø–µ—Ü–∏—Ñ–∏–∫–∞—Ü–∏—é
2. –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ v1.2
3. –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ –º–æ–¥—É–ª—è–º–∏

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- –ü–æ–ª–Ω–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è v1.2
- –ï–¥–∏–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- –ù–æ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –≤—Ä–µ–º–µ–Ω–∏

---

## ‚úÖ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥

**–†–µ–∫–æ–º–µ–Ω–¥—É—é:** –í–∞—Ä–∏–∞–Ω—Ç A (–ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ–µ —É–ª—É—á—à–µ–Ω–∏–µ)

1. –ò—Å–ø—Ä–∞–≤–∏—Ç—å —ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç: –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π –∫–ª—é—á –¥–ª—è CdLS
2. –î–æ–±–∞–≤–∏—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–π –≤—ã–≤–æ–¥ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–Ω–∞—á–µ–Ω–∏–π
3. –ü–æ–ª—É—á–∏—Ç—å –ø–µ—Ä–≤—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
4. –ó–∞—Ç–µ–º –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–∏ v1.2

---

**–°—Ç–∞—Ç—É—Å:** –ì–æ—Ç–æ–≤ –∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—é  
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** –í—ã—Å–æ–∫–∏–π  
**–í—Ä–µ–º—è –Ω–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ:** 10-15 –º–∏–Ω—É—Ç








