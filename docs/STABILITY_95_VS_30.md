# Почему одни границы TAD стабильны в 95% клеток, а другие — только в 30%?

## Вопрос

**Почему одни границы TAD стабильны в 95% клеток, а другие — только в 30%?**

Это фундаментальный вопрос о детерминизме vs стохастичности в формировании геномной архитектуры.

---

## Экспериментальные наблюдения

### Высокостабильные границы (90-95% воспроизводимость)

**Характеристики:**
- Сильные CTCF сайты (ChIP-seq signal > 10)
- Низкое метилирование CpG (< 0.2)
- Обогащены G4-структурами
- Консервативные TE мотивы (Alu, SINE)
- Ранние события экструзии

**Примеры:**
- Границы доменов Hox
- Границы между активными и неактивными хроматинами
- Конститутивные TAD boundaries

### Вариабельные границы (30-50% воспроизводимость)

**Характеристики:**
- Слабые или отсутствующие CTCF сайты
- Высокое метилирование (> 0.7)
- Конфликтующие non-B DNA структуры
- Нестабильные TE insertions
- Поздние события экструзии

**Примеры:**
- Facultative TAD boundaries
- Границы в гетерохроматине
- Временные границы при дифференцировке

---

## Текущая ARCHCODE модель

### RS-06: Boundary Stability Predictor

**Формула стабильности:**
```
Stability = S_ctcf × (1 + E_barrier) × E_epi × (1 + M_te) × T_time
```

**Где:**
- `S_ctcf`: CTCF strength (0.0-1.0)
- `E_barrier`: Energy barrier contribution (G4, Z-DNA, R-loops)
- `E_epi`: Epigenetic context (methylation, histone marks)
- `M_te`: TE motif effects (-1.0 to +1.0)
- `T_time`: Temporal order probability (0.0-1.0)

**Категоризация:**
- **Stable**: Stability ≥ 0.7 → >90% клеток
- **Variable**: Stability ≤ 0.4 → <50% клеток
- **Intermediate**: 0.4 < Stability < 0.7

### Интеграция факторов

ARCHCODE агрегирует факторы из всех модулей:

1. **CTCF strength** (из ChIP-seq или sequence motifs)
2. **Energy barriers** (G4, Z-DNA, R-loops из `nonB_logic`)
3. **Epigenetic marks** (methylation из `epigenetic_compiler`)
4. **TE motifs** (из `te_grammar`)
5. **Temporal factors** (из `extrusion_engine`)

---

## Результаты эксперимента E-S1-L2-01

### Factor Decomposition Analysis

**Корреляции факторов с предсказанной стабильностью:**

| Фактор | Корреляция | Интерпретация |
|--------|-----------|---------------|
| CTCF strength | +0.747 | Сильный положительный эффект |
| Barrier strength | -0.652 | Высокие барьеры → нестабильность |
| Methylation | -0.794 | Высокое метилирование → нестабильность |
| TE effects | -0.668 | Негативные TE эффекты → нестабильность |

**Корреляция предсказанной vs экспериментальной стабильности:**
- **0.790** — хорошее соответствие модели

### Feature Importance (vs экспериментальные данные)

| Фактор | Важность | Роль |
|--------|----------|------|
| CTCF | 0.996 | Критический фактор |
| Methylation | 0.977 | Сильный негативный эффект |
| Barrier | 0.974 | Влияет на стабильность |
| TE | 0.958 | Модифицирует стабильность |

### Пороговый анализ

**Стабильные границы (Stability ≥ 0.7):**
- Средний CTCF strength: **0.9**
- Средний barrier strength: **0.1** (низкие барьеры)
- Среднее метилирование: **0.1** (низкое)

**Вариабельные границы (Stability ≤ 0.4):**
- Средний CTCF strength: **0.3**
- Средний barrier strength: **0.8** (высокие барьеры)
- Среднее метилирование: **0.9** (высокое)

---

## Механизмы стабильности

### 1. CTCF-Centric механизм (Hypothesis A)

**Утверждение:** Сильные CTCF сайты → стабильные границы

**Механизм:**
- CTCF создает прочный барьер для loop extrusion
- Сильные сайты связываются надежно в большинстве клеток
- Слабые сайты → стохастическое связывание → вариабельность

**Ограничения:**
- Не все сильные CTCF сайты создают стабильные границы
- Нужны дополнительные факторы

### 2. Multi-Factor механизм (Hypothesis B) — Текущая модель

**Утверждение:** Комбинация CTCF + энергетические барьеры + эпигенетика

**Механизм:**
- CTCF обеспечивает базовую стабильность
- Energy barriers усиливают или ослабляют границы
- Methylation инактивирует CTCF → нестабильность
- TE motifs модифицируют локальную топологию

**Формула:**
```
Stability = S_ctcf × (1 + E_barrier) × E_epi × (1 + M_te) × T_time
```

**Преимущества:**
- Учитывает множественные факторы
- Объясняет вариабельность через комбинации
- Интегрирует все модули ARCHCODE

### 3. Temporal механизм (Hypothesis C)

**Утверждение:** Порядок событий экструзии определяет стабильность

**Механизм:**
- Ранние события → больше времени для стабилизации
- Поздние события → конкуренция с другими процессами
- Temporal factor учитывает порядок

**Ограничения:**
- Требует детального моделирования временной динамики
- Сложно измерить экспериментально

---

## Как ARCHCODE помогает найти ответ

### 1. Систематическое сравнение гипотез

**VIZIR Framework:**
- Каждая гипотеза формализована как Engineering Unknown
- Альтернативные гипотезы встроены в конфиги
- Можно запускать одну и ту же симуляцию с разными гипотезами

**Пример:**
```python
# Hypothesis A: CTCF-centric
config_S1_hypothesis_A = {"ctcf_weight": 1.0, "other_weights": 0.0}

# Hypothesis B: Multi-factor (текущая)
config_S1_hypothesis_B = {"ctcf_weight": 1.0, "barrier_weight": 1.0, ...}

# Сравнить результаты
```

### 2. Калибровка модели на экспериментальных данных

**Experiment E-S1-L2-01:**
- Разложение факторов стабильности
- Корреляция с экспериментальными данными
- Feature importance analysis

**Результаты:**
- Модель предсказывает стабильность с корреляцией **0.790**
- CTCF — критический фактор (importance 0.996)
- Methylation — сильный негативный эффект (importance 0.977)

### 3. Пороговый анализ

**Определение критических значений:**
- Стабильные границы: CTCF ≥ 0.9, Methylation ≤ 0.1
- Вариабельные границы: CTCF ≤ 0.3, Methylation ≥ 0.9

**Применение:**
- Предсказание стабильности для новых границ
- Идентификация критических факторов

### 4. Интеграция всех модулей

**Полная цепочка:**
```
Extrusion Engine → Stability Predictor → Collapse Simulator → Risk Scoring
```

**Преимущества:**
- Учитывает все факторы одновременно
- Моделирует полную причинную цепочку
- Предсказывает последствия нестабильности

---

## План дальнейших исследований

### Phase 1: Расширение данных

**Задачи:**
1. Собрать больше экспериментальных данных о стабильности
2. Интегрировать single-cell Hi-C данные
3. Добавить больше границ в датасет

**Ожидаемый результат:**
- Более надежная калибровка модели
- Лучшее понимание вариабельности

### Phase 2: Улучшение модели

**Задачи:**
1. Исследовать нелинейные взаимодействия факторов
2. Добавить контекстные зависимости
3. Улучшить temporal factor

**Ожидаемый результат:**
- Более точные предсказания
- Лучшее понимание механизмов

### Phase 3: Валидация на реальных данных

**Задачи:**
1. Предсказать стабильность для известных границ
2. Сравнить с экспериментальными данными
3. Идентифицировать новые стабильные/вариабельные границы

**Ожидаемый результат:**
- Валидация модели
- Новые биологические инсайты

---

## Выводы

### Текущее понимание

1. **CTCF — критический фактор**, но не единственный
2. **Methylation — сильный негативный эффект** на стабильность
3. **Energy barriers** могут усиливать или ослаблять границы
4. **TE motifs** модифицируют локальную топологию

### Модель ARCHCODE

**Формула стабильности:**
```
Stability = S_ctcf × (1 + E_barrier) × E_epi × (1 + M_te) × T_time
```

**Категоризация:**
- Stable (≥ 0.7): >90% клеток
- Variable (≤ 0.4): <50% клеток
- Intermediate: 0.4-0.7

**Корреляция с экспериментальными данными:** **0.790**

### Следующие шаги

1. **Расширить экспериментальные данные**
2. **Улучшить модель** (нелинейные взаимодействия)
3. **Валидировать на реальных данных**
4. **Исследовать новые факторы** (histone marks, transcription)

---

## Ссылки

- **RS-06**: Boundary Stability Predictor
- **RS-08**: TAD Boundary Stability Variation (95% vs 30%)
- **Experiment E-S1-L2-01**: Stability Factor Decomposition
- **S1**: TAD Boundary Determinism (Engineering Unknown)
- **L2**: Epigenetic Compiler Methylation Threshold (Engineering Unknown)

---

**Дата:** 23 ноября 2025  
**Статус:** Исследование в процессе  
**Корреляция модели:** 0.790







