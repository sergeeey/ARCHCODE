# Boundary Stability Predictor - Research Question

## Вопрос

**Почему некоторые границы TAD стабильны между клетками (>90% воспроизводимость), а другие вариабельны (<50%)?**

## Контекст проблемы

### Наблюдаемый феномен

- **Стабильные границы**: Воспроизводятся в >90% клеток популяции
- **Вариабельные границы**: Появляются только в <50% клеток
- Оба типа формируются через loop extrusion с CTCF-барьерами
- Разница НЕ объясняется только силой CTCF-сайта

### Инженерная значимость

Для ARCHCODE это критично, потому что:
1. Стабильность границы → предсказуемость топологии
2. Вариабельность → стохастичность в митозе → риск меротелии
3. Нужна модель предсказания стабильности для каждой позиции

## Что знает наука

### Известные факторы стабильности

1. **CTCF сила** (базовая, но недостаточная)
   - Сильные CTCF сайты → более стабильные границы
   - Но не все сильные сайты создают стабильные границы

2. **Энергетический ландшафт**
   - Non-B DNA структуры (G4, Z-DNA) влияют на стабильность
   - Барьеры могут усиливать или ослаблять границы

3. **Эпигенетический контекст**
   - Метилирование CpG → ослабление CTCF → вариабельность
   - Гистоновые модификации влияют на доступность

4. **TE-мотивы**
   - Некоторые транспозоны создают стабильные границы
   - Другие разрушают границы (WAPL-recruiting)

5. **Временная динамика**
   - Порядок загрузки когезина влияет на результат
   - Ранние события → более стабильные границы

### Неизвестное

- **Механизм детерминизма**: Почему одни границы детерминированы, другие стохастичны?
- **Пороговые значения**: Какие комбинации факторов дают стабильность?
- **Временная зависимость**: Как порядок событий влияет на финальную структуру?

## Инженерная модель

### Гипотеза

Стабильность границы определяется **мультипликативной комбинацией** факторов:

```
Stability = f(CTCF_strength, Energy_landscape, Epigenetics, TE_motifs, Temporal_order)
```

### Модель факторов

1. **CTCF Strength (S_ctcf)**: 0.0-1.0
   - Базовая сила CTCF сайта
   - Из ChIP-seq данных или мотивов

2. **Energy Landscape (E_barrier)**: 0.0-1.0
   - Комбинированная сила non-B DNA барьеров
   - G4 + Z-DNA + R-loops (иерархия)

3. **Epigenetic Context (E_epi)**: 0.0-1.0
   - Метилирование CpG → снижение
   - Гистоновые модификации → усиление

4. **TE Motifs (M_te)**: -1.0 to +1.0
   - Положительные: стабилизируют границы
   - Отрицательные: разрушают (WAPL-recruiting)

5. **Temporal Factor (T_time)**: 0.0-1.0
   - Ранние события → выше стабильность
   - Поздние события → вариабельность

### Формула стабильности

```
Stability = S_ctcf × (1 + E_barrier) × E_epi × (1 + M_te) × T_time
```

Где:
- `Stability > 0.7` → стабильная граница (>90% клеток)
- `Stability < 0.4` → вариабельная граница (<50% клеток)
- `0.4 ≤ Stability ≤ 0.7` → промежуточная стабильность

## Модуль для ARCHCODE

### `boundary_stability_predictor`

**Расположение**: `src/boundary_stability/`

**Компоненты**:
1. `stability_calculator.py` - Основной калькулятор стабильности
2. `factor_aggregator.py` - Агрегация факторов из разных модулей
3. `stability_model.py` - Модель предсказания

**Интеграция**:
- Входы из: `archcode_core` (CTCF), `nonB_logic` (барьеры), `epigenetic_compiler` (метилирование), `te_grammar` (мотивы)
- Выход: Вероятность стабильности для каждой позиции границы

**Конфигурация**: `config/boundary_stability.yaml`

## Research Specification

**RS-06: Boundary Stability Predictor**

- Goal: Предсказать стабильность TAD границ
- Method: Мультипликативная модель факторов
- Deliverable: `boundary_stability_predictor` модуль
- Integration: Все модули ARCHCODE

## Risk Matrix Entry

**Risk B1: Boundary Stability Determinism**

- Category: Biological Logic
- Uncertainty: 0.7
- Impact: 0.8
- Priority: 0.56
- Status: Open







